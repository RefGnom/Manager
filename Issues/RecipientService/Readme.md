# Описание сервиса

RecipientService - это сервис для работы с пользователем:

1. Аутентификация пользователя;
2. Авторизация с разграничением прав на разные ресурсы;
3. Хранение информации о пользователе;
4. Потенциальная монетизация за использование Manager.

# Разработка

### Шаг 1

Начинаем проектировать архитектуру серверного приложения, которая будет
включать в себя:

* Создание аккаунта для пользователя;
* Сохранение его информации в бд;
* Аутентификацию пользователя.

Предварительно хранить в базе будем:

* `RecipientAccount` - табличка с аккаунтами пользователя
    * `Guid Id` - уникальный идентификатор пользователя в среде Manager
    * `string Login` - логин пользователя
    * `string PasswordHash` - хэш пароля пользователя
    * `TimeZoneInfo RecipientTimeZone` - информация о часовом поясе пользователя
    * `DateTime CreatedUtc` - время создания аккаунта
    * `DateTime UpdatedUt` - время обновления аккаунта
    * `RecipientAccountState State` - состояние аккаунта
    * `RecipientAccountExtendedState ExtendedState` - расширенное состояние аккаунта
* `RecipientAuthorization` (Не нужна на первом шаге)
    * `Guid Id` - идентификатор сущности авторизации
    * `Guid RecipientId` - идентификатор пользователя
    * `string[] AllowedServices` - доступные сервисы для использования
    * `string[] AllowedResources` - доступные ресурсы для использования
    * `DateTime CreatedUtc` - время создания сущности авторизации
    * `DateTime UpdatedUt` - время обновления сущности авторизации

`RecipientAccountState` имеет следующие значения:

* `Active` - Активный. Разрешает пользоваться аккаунтом
* `Deleted` - Удалённый. Запрещает пользоваться аккаунтом
* `Banned` - Заблокированный. Запрещает пользоваться аккаунтом

`RecipientAccountExtendedState` имеет следующие значения:

* `Active` - Активный. Разрешает пользоваться аккаунтом
* `Restored` - Восстановленный. Разрешает пользоваться аккаунтом
* `Unbanned` - Разбаненный. Разрешает пользоваться аккаунтом
* `DeletedDueToRequest` - Удалён по запросу пользователя. Запрещает пользоваться аккаунтом
* `BannedDueToNonPayment` - Заблокированный из-за неуплаты. Запрещает пользоваться аккаунтом

#### Результат

После первого шага у нас должно получится простое приложение, которое позволяет:

1. Создать аккаунт пользователя с логином и паролем
2. Получить аккаунт по его идентификатору `RecipientId`
3. Удалить аккаунт (soft-delete) по его идентификатору `RecipientId`
4. Поменять модель аккаунта. Логин, пароль, временную зону
5. Получить статус авторизации по идентификатору `RecipientId`.
   Временно сделать заглушку, чтобы всегда возвращался ответ с успешной авторизацией
6. Логика покрыта юнит и интеграционными тестами

### Шаг 2

Нужно написать C# клиент для RecipientService. В нём должны быть реализованны созданные методы в шаге 1.
Можно ориентироваться на `AuthenticationService.Client`

#### Результат

В клиенте должны быть следующие методы:

1. Создание аккаунта
2. Получение аккаунта
3. Удалить аккаунт
4. Обновить аккаунт
5. Получение статуса авторизации

### Шаг 3

Реализация авторизации по сервису и ресурсу.